<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>UXAI</title>

  <!-- Bootstrap core CSS -->
  <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom styles for this template -->
  <link href="css/simple-sidebar.css" rel="stylesheet">

  <script src="https://d3js.org/d3.v4.min.js"></script>

</head>

<body>

  <div class="d-flex" id="wrapper">

    <!-- Sidebar -->
    <div class="bg-light border-right" id="sidebar-wrapper">
      <div class="sidebar-heading">UXAI</div>
      <div class="list-group list-group-flush">
        <a href="/index.html" class="list-group-item list-group-item-action active">What is AI?</a>
        <div class="list-group">
          <a href="#introduction" class="list-group-item">Introduction</a>
          <a href="#aiIndustry" class="list-group-item">AI Industry</a>
          <a href="#aiApplications" class="list-group-item">AI Applications</a>
        </div>

        <a href="/what-is-explainable-ai.html" class="list-group-item list-group-item-action bg-light">What is Explainable AI?</a>

        <a href="how-might-we-explain-ai.html" class="list-group-item list-group-item-action bg-light">How Might We Explain AI?</a>

        <a href="xai-ux-toolkit.html" class="list-group-item list-group-item-action bg-light">XAI UX Toolkit</a>

        <a href="/glossary.html" class="list-group-item list-group-item-action bg-light">Glossary</a>
      </div>
    </div>
    <!-- /#sidebar-wrapper -->

    <!-- Page Content -->
    <div id="page-content-wrapper">

      <!-- <nav class="navbar navbar-expand-lg navbar-light bg-light border-bottom">
        <button class="btn btn-primary" id="menu-toggle">Toggle Menu</button>

        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav ml-auto mt-2 mt-lg-0">
            <li class="nav-item active">
              <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#">Link</a>
            </li>
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                Dropdown
              </a>
              <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                <a class="dropdown-item" href="#">Action</a>
                <a class="dropdown-item" href="#">Another action</a>
                <div class="dropdown-divider"></div>
                <a class="dropdown-item" href="#">Something else here</a>
              </div>
            </li>
          </ul>
        </div>
      </nav> -->

      <!-- Header -->
      <div class="container-fluid padding">
        <div class="row text-center padding">
          <h1 class="mt-4">A Visual Introduction to Designing Explainable AI</h1>
        </div>
      </div>

      <!-- Introduction -->
      <div class="container-fluid padding" id="introduction">
        <div class="row padding">
          <div class="col-lg-8">
            <h2 class="mt-4">Introduction</h2>
            <p>AI is the simulation of human thought processes in a computerized model. AI involves self-learning systems that use data mining, pattern recognition and natural language processing to mimic the way the human brain works.</p>
            <p>These systems learn at scale, reason with purpose and interact with humans naturally. What search is to information retrieval, AI is to better, more-informed decision-making. In short, they help human experts make better decisions.</p>
          </div>
          <div class="col-lg-4">
            <h3 class="mt-4">Characteristics of AI</h3>
            <ul>
              <li>Understands</li>
              <li>Reasons</li>
              <li>Learns</li>
              <li>Interacts</li>
            </ul>
        </div>
        </div>
      </div>

      <!-- AI Industry -->
      <div class="container-fluid padding" id="aiIndustry">
        <div class="row padding">
          <div class="col-lg-8">
            <h2 class="mt-4">AI in Industry</h2>
            <p>With the development of AI, countries and companies are increasingly investing in AI. (Industry related sentense)</p>
          </div>
          <div class="col-lg-4">
            <h3 class="mt-4">$2.9 Trillion</h3>
            <p>In 2021, artificial intelligence (AI) augmentation will create $2.9 trillion of business value</p>
        </div>
        </div>
      </div>

      <!-- AI Applications -->
      <div class="container-fluid padding" id="aiApplications">
        <div class="row padding">
          <div class="col-lg-8">
            <h2 class="mt-4">AI Applications</h2>
            <p>With the development of AI, countries and companies are increasingly investing in AI. (Industry related sentense)</p>
          </div>
          <div class="col-lg-4">
            <h3 class="mt-4">$2.9 Trillion</h3>
            <p>In 2021, artificial intelligence (AI) augmentation will create $2.9 trillion of business value</p>
        </div>
        </div>
      </div>

      <div class="container-fluid padding">
        <div class="row padding" id="d3test">
          <script>
            let graphData = JSON.parse(JSON.stringify({
              "nodes": [
                {id: 1, name: "LAX", flights: 39636042},
                {id: 2, name: "SFO", flights: 25707101},
                {id: 3, name: "SAN", flights: 10340164},
                {id: 4, name: "OAK", flights: 5934639},
                {id: 5, name: "SJC", flights: 5321603},
                {id: 6, name: "SNA", flights: 5217242},
                {id: 7, name: "SMF", flights: 4969366},
                {id: 8, name: "ONT", flights: 2104625},
                {id: 9, name: "BUR", flights: 2077892},
                {id: 10, name: "LGB", flights: 1386357}
              ],
              "links": [
                {source: 1, target: 2, flightTime: 60},
                {source: 1, target: 3, flightTime: 55},
                {source: 1, target: 4, flightTime: 80},
                {source: 1, target: 5, flightTime: 75},
                {source: 1, target: 7, flightTime: 85},
                {source: 2, target: 1, flightTime: 80},
                {source: 2, target: 3, flightTime: 100},
                {source: 2, target: 6, flightTime: 100},
                {source: 2, target: 7, flightTime: 50},
                {source: 2, target: 8, flightTime: 90},
                {source: 2, target: 9, flightTime: 80},
                {source: 3, target: 1, flightTime: 55},
                {source: 3, target: 2, flightTime: 100},
                {source: 3, target: 4, flightTime: 85},
                {source: 3, target: 5, flightTime: 75},
                {source: 3, target: 7, flightTime: 90},
                {source: 4, target: 1, flightTime: 85},
                {source: 4, target: 6, flightTime: 85},
                {source: 4, target: 8, flightTime: 80},
                {source: 4, target: 9, flightTime: 70},
                {source: 4, target: 10, flightTime: 80},
                {source: 5, target: 1, flightTime: 80},
                {source: 5, target: 3, flightTime: 80},
                {source: 5, target: 6, flightTime: 75},
                {source: 5, target: 8, flightTime: 75},
                {source: 5, target: 9, flightTime: 60},
                {source: 5, target: 10, flightTime: 75},
                {source: 6, target: 2, flightTime: 90},
                {source: 6, target: 4, flightTime: 75},
                {source: 6, target: 5, flightTime: 70},
                {source: 6, target: 7, flightTime: 85},
                {source: 7, target: 1, flightTime: 85},
                {source: 7, target: 2, flightTime: 50},
                {source: 7, target: 3, flightTime: 85},
                {source: 7, target: 6, flightTime: 85},
                {source: 7, target: 8, flightTime: 75},
                {source: 7, target: 9, flightTime: 75},
                {source: 7, target: 10, flightTime: 80},
                {source: 8, target: 2, flightTime: 90},
                {source: 8, target: 4, flightTime: 75},
                {source: 8, target: 5, flightTime: 70},
                {source: 8, target: 7, flightTime: 80},
                {source: 9, target: 2, flightTime: 90},
                {source: 9, target: 4, flightTime: 75},
                {source: 9, target: 5, flightTime: 70},
                {source: 9, target: 7, flightTime: 80},
                {source: 10, target: 2, flightTime: 85},
                {source: 10, target: 4, flightTime: 75},
                {source: 10, target: 5, flightTime: 75},
                {source: 10, target: 7, flightTime: 80},
              ]
            }))

            const allNodesNames = graphData.nodes.map(function(d){return d.name});
            
            var idToNode = (function()
            {
              let dict = {};
              graphData.nodes.forEach(function(n) {
                dict[n.id] = n;
              });
              return dict;
            }) ();

            var idToTargetNodes = function()
            {
              let dict = {};
              graphData.nodes.forEach(function (n) {
                dict[n.id] = [];
                graphData.links.forEach(function (l) {
                    if (l.source === n.id) {
                          dict[n.id].push(l.target);
                    }
                });
              });
              return dict;
            }

            let margin = ({top: 20, bottom: 20, left: 50, right: 50});

            let height = 550 - margin.top - margin.bottom;

            let width = 850;

            const xScale = d3.scalePoint()
              .domain(allNodesNames)
              .range([0,width]);

            const yScale = d3.scalePoint()
              .domain(allNodesNames)
              .range([0,height]);

            let node = d3.select("#d3test");
              
            let container = node.append("svg")
            .attr("width", width+margin.left+margin.right)
            .attr("height", height+margin.top+margin.bottom);

            // VG: add title
            let title = container
              .append("text")
              .attr("x", margin.left)
              .attr("y", margin.top + 10)
              .style("font-weight", "bold")
              .style("font-size", 24)
              .text("California's 10 Busiest Airports and Their Nonstop Connections to Each Other");
            
            // VG: add narrative
            var narrative = container
              .append("text")
              .attr("x", margin.left)
              .attr("y", margin.top + 50)
              .text("Mouse over an airport to see how many flights there were in 2016 (most recent data available)");
            
            const arcGroup = container
                .append("g")
                  .attr("transform", "translate(" + margin.left + "," + margin.top + ")")
              
            // create the nodes
            const nodes = arcGroup.selectAll("nodes")
              .data(graphData.nodes)
              .enter().append("circle")
                .attr("cx", d => xScale(d.name))
                .attr("cy", height-100)
                .attr("r", d => (d.flights/1000000) + 7) // VG change: dynamic radius based on number of flights ("alter what the arcs mean")
                .attr("fill", "steelblue")
                .attr("id", d => d.id)  // need to add the ID to use below
            
            // create the node labels
            arcGroup.selectAll("nodeLabels")
              .data(graphData.nodes)
              .enter().append("text")
                .attr("x", d => xScale(d.name))
                .attr("y", height-20)
                .attr("fill", "darkgrey")
                .style("text-anchor", "middle")
                .text(d => d.name)
            
            // This code builds up the SVG path element; see nodesAndArcs for details
            function buildArc(d) {
                let start = xScale(idToNode[d.source].name);
                let end = xScale(idToNode[d.target].name);
                const arcPath = ['M', start, height-100, 'A', (start - end)/2, ',', (start-end)/2, 0,0,",",
                            start < end ? 1: 0, end, height-100].join(' ');
                return arcPath;   
            }
            
            // create the arcs
            let arcs = arcGroup.selectAll("arcs")
              .data(graphData.links)
              .enter().append("path")
              .attr("id", d => `${d.source}_${d.target}_path`) //VG: create id for textPath href
              .style("fill", "none")
              .attr("stroke", "none")
              .attr("d", d => buildArc(d));
            
            // VG: filter graphData to get flight time for arc label
            function getFlightTime(source, target) {
              return graphData.links.filter(d => d.source == source && d.target == target)[0].flightTime; 
            }
            
            // VG: add labels to arcs
            let arcLabels = arcGroup.selectAll("arcs")
              .data(graphData.links)
              .enter().append("text")
              //Move the labels below the arcs for those slices with an end angle greater than 90 degrees
              .attr("dy", function(d,i) { return (d.endAngle > 90 * Math.PI/180 ? 18 : -11); })
              .append("textPath")
              .attr("xlink:href", d => `#${d.source}_${d.target}_path`)
              .style("text-anchor", "middle")
              .style("fill", "none")
              .style("font-size", 10)
              .style("text-orientation", "upright")
              .attr("startOffset", "50%")
              .text(d => getFlightTime(d.source, d.target) + " minutes");
            
            // VG: add plane icons
            // adapted from https://observablehq.com/d/7487d7daed3116e1?collection=@i247sp20/labs
            const imageHeight = 10;
            
            let myimage = container.selectAll("image")
              .data(graphData.nodes)
              .enter().append('image')
              //.attr('xlink:href', 'https://upload.wikimedia.org/wikipedia/commons/4/47/Golf_ball.svg')
              .attr('xlink:href', 'https://upload.wikimedia.org/wikipedia/commons/7/7d/Plane_icon.svg')
              .attr('width', imageHeight)
              .attr('height', imageHeight)
              .attr('x', d => xScale(d.name) + margin.left - 5)
              .attr('y', height - 100 + margin.top - 5)
            
            // When the user mouses over a node,
            // add interactive highlighting to see connections between nodes  
            nodes.on('mouseover', function(d) {
              
              // remember which node is the selected node
              let thisNode = this;
                
                //  highlight  the selected node
              d3.select(this).style("fill", "firebrick");
                
              // style the arcs      
              arcs
                .style('stroke', function (arcd) { 
                    return  arcd.source === d.id  ? 'firebrick' : 'none';})
                .style('stroke-width', function (arcd) {
                    return arcd.source === d.id ? 4 : 1;})      
                .attr("stroke-dasharray", function(arcd) {
                      return  arcd.source === d.id  ? this.getTotalLength() : 0;})
                .attr("stroke-dashoffset", function(arcd) 
                      { return  arcd.source === d.id  ? this.getTotalLength() : 0;})
                    // reveal the arcs  
                .transition()
                .duration(3000)
                .attr("stroke-dashoffset", 0)
              
              // VG: show flight times on mouseover
              arcLabels
                .style("fill", arcd => arcd.source === d.id ? "black" : "none")
              
              // VG: update narrative
              // regex source: https://stackoverflow.com/questions/2901102/how-to-print-a-number-with-commas-as-thousands-separators-in-javascript
              narrative
                .text(`In 2016, there were ${d.flights.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",")} flights from ${d.name}`)
              
                /* This was tricky to figure out.  To make this code clean, I had to add the 
                idToTargetNodes function in the Data section of the notebook to get a list of nodes
                linked to from the user selected node.   
                
                This function grabs the nodes selection and determines the color of every node.
                Turn the node firebrick if it is in the list of target nodes or if it is this node itself.
                I use the + before the node IDs to make them both integers instead of strings.
                */
              
                .on("end", function() {
                  nodes
                    .style("fill", function(noded) {
                    return idToTargetNodes[thisNode.id].includes(noded.id) || +thisNode.id === +noded.id 
                      ? "firebrick" : "steelblue"});
              });
            });
            
            // remove highlighting when user mouse moves out of node by restoring default colors and thickness
            nodes.on('mouseout', function () {   
              nodes.style("fill", "steelblue");
              arcs.style('stroke', 'none');
              arcs.style('stroke-width', 1);
              
              // VG: update arc labels on mouse out
              arcLabels.style("fill", "none");
            });
          </script>
        </div>
      </div>



    </div>
    <!-- /#page-content-wrapper -->

  </div>
  <!-- /#wrapper -->

  <!-- Bootstrap core JavaScript -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  <!-- Menu Toggle Script -->
  <!-- <script>
    $("#menu-toggle").click(function(e) {
      e.preventDefault();
      $("#wrapper").toggleClass("toggled");
    });
  </script> -->

</body>

</html>
